{"componentChunkName":"component---node-modules-narative-gatsby-theme-novela-src-templates-article-template-tsx","path":"/blog/2013/01/18/getting-cross-origin-resource-sharing-with-complex-jquery-ajax-requests/","result":{"data":{"allSite":{"edges":[{"node":{"siteMetadata":{"name":"dain"}}}]}},"pageContext":{"article":{"id":"d3d0d05d-6c9e-551d-9a63-7598815c60eb","slug":"/blog/2013/01/18/getting-cross-origin-resource-sharing-with-complex-jquery-ajax-requests/","secret":false,"title":"Getting Cross-origin resource sharing with complex jQuery AJAX requests","author":"Daniel Demmel","date":"January 18th, 2013","dateForSEO":"2013-01-18T00:00:00.000Z","timeToRead":2,"excerpt":"CORS can be tricky, especially if you need to do something beyond the basics like authorisation or custom headers.","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Getting Cross-origin resource sharing with complex jQuery AJAX requests\",\n  \"date\": \"2013-01-18T00:00:00.000Z\",\n  \"categories\": [\"web\", \"development\", \"jquery\", \"javascript\", \"cors\"],\n  \"author\": \"Daniel Demmel\",\n  \"hero\": \"./images/sharing.jpg\",\n  \"excerpt\": \"CORS can be tricky, especially if you need to do something beyond the basics like authorisation or custom headers.\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I\\u2019m working on an HTML5 desktop application which needs to load some HTML text from a server, but not through an existing API. So I had to find a solution which can be set up without too much backend work and make it possible for non-technical people to easily update the content. I\\u2019m assuming that the easiest setup will be using an existing CMS system with a few custom server settings to enable cross-domain communication. It\\u2019s also a security sensitive application, so the content will need to be protected with basic authorisation at least.\"), mdx(\"p\", null, \"Well, let me get things straight: CORS which is more than the simplest GET request is not easy!\"), mdx(\"p\", null, \"While trying to set up and end to end proof of concept to make sure this will work and to be able to advise with setup I ran into several blockers, so I\\u2019m going to go through them step by step.\"), mdx(\"h2\", {\n    \"id\": \"setting-up-the-jquery-ajax-request\"\n  }, \"Setting up the jQuery AJAX request\"), mdx(\"p\", null, \"For simple use cases all you need to do to is fire off a simple GET request:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"$.ajax({\\n  type: \\\"GET\\\",\\n  url: \\\"https://www.html5rocks.com/en/tutorials/file/xhr2/\\\",\\n  success: function(response) {\\n    var article = $(response)\\n      .find(\\\"article\\\")\\n      .html();\\n    $(\\\"body\\\").html(article);\\n  }\\n});\\n\")), mdx(\"p\", null, \"If the server you\\u2019re hitting is sending back the header \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Access-Control-Allow-Origin\"), \" with the value \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"*\"), \" you\\u2019re all set.\"), mdx(\"iframe\", {\n    width: \"100%\",\n    height: \"300\",\n    src: \"//jsfiddle.net/dain/0gqxsubm/1/embedded/\",\n    allowFullScreen: \"allowfullscreen\",\n    frameBorder: \"0\"\n  }), mdx(\"p\", null, \"However what I ended up with is far more complicated, as doing anything with custom headers (which included authorisation) you have to first make a so called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://web.dev/cross-origin-resource-sharing/#preflight-requests-for-complex-http-calls\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"preflight\"), \" request. This is an OPTIONS request which only asks the server if it supports all the headers needed for the \\u2018real\\u2019 request which follows.\"), mdx(\"p\", null, \"So let\\u2019s first see the full AJAX request:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"$.ajax({\\n  type: \\\"GET\\\",\\n  url: \\\"https://www.mydomain.com/myFancyContent.php\\\",\\n  headers: {\\n    MyCustomHeader: \\\"important information\\\"\\n  },\\n  xhrFields: {\\n    withCredentials: true\\n  },\\n  username: \\\"myuser\\\",\\n  password: \\\"mypassword\\\",\\n  success: function() {\\n    console.log(\\\"success\\\");\\n  },\\n  error: function() {\\n    console.log(\\\"failure\\\");\\n  }\\n});\\n\")), mdx(\"p\", null, \"JQuery has some helpers for authorisation, so the easiest way to get it working is setting \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"xhrFields.withCredentials\"), \" to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \" and passing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"username\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"password\"), \" as separate parameters, this way we don\\u2019t have to worry about the intricacies of creating the auth hash ourselves.\"), mdx(\"p\", null, \"Another convenience property is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"headers\"), \" which you can use to inject any custom headers you might need, without having to manually do it with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"beforeSend\"), \".\"), mdx(\"h2\", {\n    \"id\": \"apache-config\"\n  }, \"Apache config\"), mdx(\"p\", null, \"Another big stumbling block for me was to get the settings for Apache right.\"), mdx(\"p\", null, \"The very first thing you need to do is making sure \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"mod_headers\"), \" is enabled, which can be as simple as:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-sh\"\n  }), \"sudo a2enmod headers\\nsudo /etc/init.d/apache2 force-reload\\n\")), mdx(\"p\", null, \"Once that\\u2019s done, you can either edit your main \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"httpd.conf\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"apache.conf\"), \" files, or just create an \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".htaccess\"), \" file in the folder you want to enable CORS in.\"), mdx(\"p\", null, \"These are the settings I ended up with after a lot of experimentation:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-conf\"\n  }), \"SetEnvIf Origin ^(.*)$ ORIGIN_DOMAIN=$0\\n<Files \\\"*\\\">\\n  Header add Access-Control-Allow-Origin %{ORIGIN_DOMAIN}e\\n  Header add Access-Control-Allow-Methods \\\"GET, OPTIONS\\\"\\n  Header add Access-Control-Allow-Headers \\\"Authorization, X-Requested-With, Content-Type, Origin, Accept\\\"\\n  Header add Access-Control-Allow-Credentials \\\"true\\\"\\n</Files>\\n\")), mdx(\"p\", null, \"The first line makes sure that \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Origin\"), \" is echoed back, because as it turns out once you have some custom headers a simple \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"*\"), \" in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Access-Control-Allow-Origin\"), \" won\\u2019t do any more. You can do some URL filtering here if you want, but this setup makes sure that even \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"file:///\"), \" works which is great for development.\"), mdx(\"p\", null, \"In \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Access-Control-Allow-Methods\"), \" we make sure that \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OPTIONS\"), \" will work, and with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Access-Control-Allow-Headers\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Access-Control-Allow-Credentials\"), \" we set everything up for a basic authorisation handshake.\"), mdx(\"p\", null, \"Annoyingly none of these worked on the simple HTML file I uploaded, until as a desperate idea after a few hours of futile attempts I tried renaming it to PHP extension which made Apache suddenly apply all of them.\"), mdx(\"p\", null, \"If that wasn\\u2019t enough, the unregistered development HTTPS security certificate also blocked my attempts to get things working. If you open any URL on the server you\\u2019re using and accept the certificate this problem will go away, otherwise the options are to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://superuser.com/questions/27268/how-do-i-disable-the-warning-chrome-gives-if-a-security-certificate-is-not-trust\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"install / import the certificate on a system level\"), \" or to start the browser with some flags like \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--allow-running-insecure-content\"), \" for Chrome.\"), mdx(\"p\", null, \"Hope this will help someone else facing the same problems!\"), mdx(\"h2\", {\n    \"id\": \"credits\"\n  }, \"Credits\"), mdx(\"p\", null, \"Hero image: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://en.kremlin.ru/events/president/news/52898/photos/45602\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"http://en.kremlin.ru/events/president/news/52898/photos/45602\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAFd+HYmsCWM/wD/xAAcEAAABgMAAAAAAAAAAAAAAAABAgQREjEAAxT/2gAIAQEAAQUC6XATMnBTHGia9Jr/AP/EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8BjVv/xAAXEQEBAQEAAAAAAAAAAAAAAAABAAIR/9oACAECAQE/AXhOS//EABwQAAICAgMAAAAAAAAAAAAAAAARAUEQITFRcf/aAAgBAQAGPwJT0LjViRFk+Y//xAAbEAEAAgMBAQAAAAAAAAAAAAABACERMVGBQf/aAAgBAQABPyF5lTT95AXF0mUMWPsQ0PUd2KUn/9oADAMBAAIAAwAAABAPL//EABcRAAMBAAAAAAAAAAAAAAAAAAABETH/2gAIAQMBAT8QV6KP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/ENghJdS//8QAHBABAQACAwEBAAAAAAAAAAAAAREAMSFBYYGR/9oACAEBAAE/EO4ohiIRXifmC7Q9GyRxsoHrgcGsKBDZrfkxygBqHhcVQATP/9k=","aspectRatio":1.6206896551724137,"src":"/static/5d36cd1445046b46fa32512a03ac72a0/58fe7/sharing.jpg","srcSet":"/static/5d36cd1445046b46fa32512a03ac72a0/e0f30/sharing.jpg 236w,\n/static/5d36cd1445046b46fa32512a03ac72a0/86afd/sharing.jpg 472w,\n/static/5d36cd1445046b46fa32512a03ac72a0/58fe7/sharing.jpg 944w,\n/static/5d36cd1445046b46fa32512a03ac72a0/02748/sharing.jpg 1416w,\n/static/5d36cd1445046b46fa32512a03ac72a0/f2a59/sharing.jpg 1880w","srcWebp":"/static/5d36cd1445046b46fa32512a03ac72a0/99fbb/sharing.webp","srcSetWebp":"/static/5d36cd1445046b46fa32512a03ac72a0/77392/sharing.webp 236w,\n/static/5d36cd1445046b46fa32512a03ac72a0/1f177/sharing.webp 472w,\n/static/5d36cd1445046b46fa32512a03ac72a0/99fbb/sharing.webp 944w,\n/static/5d36cd1445046b46fa32512a03ac72a0/4a492/sharing.webp 1416w,\n/static/5d36cd1445046b46fa32512a03ac72a0/a5985/sharing.webp 1880w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAFd+HYmsCWM/wD/xAAcEAAABgMAAAAAAAAAAAAAAAABAgQREjEAAxT/2gAIAQEAAQUC6XATMnBTHGia9Jr/AP/EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8BjVv/xAAXEQEBAQEAAAAAAAAAAAAAAAABAAIR/9oACAECAQE/AXhOS//EABwQAAICAgMAAAAAAAAAAAAAAAARAUEQITFRcf/aAAgBAQAGPwJT0LjViRFk+Y//xAAbEAEAAgMBAQAAAAAAAAAAAAABACERMVGBQf/aAAgBAQABPyF5lTT95AXF0mUMWPsQ0PUd2KUn/9oADAMBAAIAAwAAABAPL//EABcRAAMBAAAAAAAAAAAAAAAAAAABETH/2gAIAQMBAT8QV6KP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/ENghJdS//8QAHBABAQACAwEBAAAAAAAAAAAAAREAMSFBYYGR/9oACAEBAAE/EO4ohiIRXifmC7Q9GyRxsoHrgcGsKBDZrfkxygBqHhcVQATP/9k=","aspectRatio":1.6206896551724137,"src":"/static/5d36cd1445046b46fa32512a03ac72a0/1dc0b/sharing.jpg","srcSet":"/static/5d36cd1445046b46fa32512a03ac72a0/3a5ce/sharing.jpg 163w,\n/static/5d36cd1445046b46fa32512a03ac72a0/05730/sharing.jpg 327w,\n/static/5d36cd1445046b46fa32512a03ac72a0/1dc0b/sharing.jpg 653w,\n/static/5d36cd1445046b46fa32512a03ac72a0/f72c7/sharing.jpg 980w,\n/static/5d36cd1445046b46fa32512a03ac72a0/6e4a3/sharing.jpg 1306w,\n/static/5d36cd1445046b46fa32512a03ac72a0/f2a59/sharing.jpg 1880w","srcWebp":"/static/5d36cd1445046b46fa32512a03ac72a0/0acdf/sharing.webp","srcSetWebp":"/static/5d36cd1445046b46fa32512a03ac72a0/ac59e/sharing.webp 163w,\n/static/5d36cd1445046b46fa32512a03ac72a0/7660b/sharing.webp 327w,\n/static/5d36cd1445046b46fa32512a03ac72a0/0acdf/sharing.webp 653w,\n/static/5d36cd1445046b46fa32512a03ac72a0/75470/sharing.webp 980w,\n/static/5d36cd1445046b46fa32512a03ac72a0/68d47/sharing.webp 1306w,\n/static/5d36cd1445046b46fa32512a03ac72a0/a5985/sharing.webp 1880w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAFd+HYmsCWM/wD/xAAcEAAABgMAAAAAAAAAAAAAAAABAgQREjEAAxT/2gAIAQEAAQUC6XATMnBTHGia9Jr/AP/EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8BjVv/xAAXEQEBAQEAAAAAAAAAAAAAAAABAAIR/9oACAECAQE/AXhOS//EABwQAAICAgMAAAAAAAAAAAAAAAARAUEQITFRcf/aAAgBAQAGPwJT0LjViRFk+Y//xAAbEAEAAgMBAQAAAAAAAAAAAAABACERMVGBQf/aAAgBAQABPyF5lTT95AXF0mUMWPsQ0PUd2KUn/9oADAMBAAIAAwAAABAPL//EABcRAAMBAAAAAAAAAAAAAAAAAAABETH/2gAIAQMBAT8QV6KP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/ENghJdS//8QAHBABAQACAwEBAAAAAAAAAAAAAREAMSFBYYGR/9oACAEBAAE/EO4ohiIRXifmC7Q9GyRxsoHrgcGsKBDZrfkxygBqHhcVQATP/9k=","aspectRatio":1.6206896551724137,"src":"/static/5d36cd1445046b46fa32512a03ac72a0/eaa58/sharing.jpg","srcSet":"/static/5d36cd1445046b46fa32512a03ac72a0/5a3ee/sharing.jpg 114w,\n/static/5d36cd1445046b46fa32512a03ac72a0/41f8f/sharing.jpg 229w,\n/static/5d36cd1445046b46fa32512a03ac72a0/eaa58/sharing.jpg 457w,\n/static/5d36cd1445046b46fa32512a03ac72a0/c309b/sharing.jpg 686w,\n/static/5d36cd1445046b46fa32512a03ac72a0/e3008/sharing.jpg 914w,\n/static/5d36cd1445046b46fa32512a03ac72a0/f2a59/sharing.jpg 1880w","srcWebp":"/static/5d36cd1445046b46fa32512a03ac72a0/15384/sharing.webp","srcSetWebp":"/static/5d36cd1445046b46fa32512a03ac72a0/31fce/sharing.webp 114w,\n/static/5d36cd1445046b46fa32512a03ac72a0/e3e25/sharing.webp 229w,\n/static/5d36cd1445046b46fa32512a03ac72a0/15384/sharing.webp 457w,\n/static/5d36cd1445046b46fa32512a03ac72a0/0258d/sharing.webp 686w,\n/static/5d36cd1445046b46fa32512a03ac72a0/64ea2/sharing.webp 914w,\n/static/5d36cd1445046b46fa32512a03ac72a0/a5985/sharing.webp 1880w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/5d36cd1445046b46fa32512a03ac72a0/0ff54/sharing.jpg"}}},"authors":[{"authorsPage":true,"bio":"Design technologist / web dev @berylbikes, ex @ustwo, â™¥ open source, degrowth & spiritual ecology activist, minimalist, vegetarian, @zzuuu's husband, dad, aspie\n","id":"62a803a8-015c-57d1-9846-ac8bc624ff30","name":"Daniel Demmel","featured":true,"social":[{"url":"https://twitter.com/daaain"},{"url":"https://github.com/daaain"},{"url":"https://stackoverflow.com/dain"},{"url":"https://www.linkedin.com/in/danieldemmel/"}],"slug":"/authors/daniel-demmel","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQFAv/EABcBAAMBAAAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAbc3ufDLkZNGtkj5dIEf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAgMBERIABP/aAAgBAQABBQKSpI3wnUesjg16wWhlgCxV47zDDA//xAAbEQACAQUAAAAAAAAAAAAAAAAAAQMQERIhMf/aAAgBAwEBPwGPuzBOlz//xAAXEQADAQAAAAAAAAAAAAAAAAAAAhAS/9oACAECAQE/AWMX/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEREiExQQIQUv/aAAgBAQAGPwJRa2y7npeGsChbghjqWClYG+alyf/EABwQAQACAwADAAAAAAAAAAAAAAEAESExQVFxkf/aAAgBAQABPyEn6sYSsAcSYavkJNUDh8yzMFxDpL7jhZzBDSG4XQKz/9oADAMBAAIAAwAAABAP30D/xAAZEQEBAAMBAAAAAAAAAAAAAAABABEhMVH/2gAIAQMBAT8QQUbwRyy9v//EABoRAQEAAgMAAAAAAAAAAAAAAAEAESExYZH/2gAIAQIBAT8QKmp7Ps82C//EAB4QAQADAAICAwAAAAAAAAAAAAEAESExUUGBcaHR/9oACAEBAAE/EApCz0b59xINViPWShKK5tzEVQIPofMb+SBa8DNC1jXRluokopeWX7ZeXBHOuLF8gK9Afs//2Q==","aspectRatio":1,"src":"/static/054e2aa5c688f14f7cdef9cee9915da9/fa1ea/dain.jpg","srcSet":"/static/054e2aa5c688f14f7cdef9cee9915da9/afb2b/dain.jpg 13w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/7c20e/dain.jpg 25w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/fa1ea/dain.jpg 50w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/03612/dain.jpg 75w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/61cdf/dain.jpg 100w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/25252/dain.jpg 400w","srcWebp":"/static/054e2aa5c688f14f7cdef9cee9915da9/e7b2c/dain.webp","srcSetWebp":"/static/054e2aa5c688f14f7cdef9cee9915da9/58718/dain.webp 13w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/74aad/dain.webp 25w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/e7b2c/dain.webp 50w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/ed320/dain.webp 75w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/66016/dain.webp 100w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/fc32b/dain.webp 400w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQFAv/EABcBAAMBAAAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAbc3ufDLkZNGtkj5dIEf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAgMBERIABP/aAAgBAQABBQKSpI3wnUesjg16wWhlgCxV47zDDA//xAAbEQACAQUAAAAAAAAAAAAAAAAAAQMQERIhMf/aAAgBAwEBPwGPuzBOlz//xAAXEQADAQAAAAAAAAAAAAAAAAAAAhAS/9oACAECAQE/AWMX/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEREiExQQIQUv/aAAgBAQAGPwJRa2y7npeGsChbghjqWClYG+alyf/EABwQAQACAwADAAAAAAAAAAAAAAEAESExQVFxkf/aAAgBAQABPyEn6sYSsAcSYavkJNUDh8yzMFxDpL7jhZzBDSG4XQKz/9oADAMBAAIAAwAAABAP30D/xAAZEQEBAAMBAAAAAAAAAAAAAAABABEhMVH/2gAIAQMBAT8QQUbwRyy9v//EABoRAQEAAgMAAAAAAAAAAAAAAAEAESExYZH/2gAIAQIBAT8QKmp7Ps82C//EAB4QAQADAAICAwAAAAAAAAAAAAEAESExUUGBcaHR/9oACAEBAAE/EApCz0b59xINViPWShKK5tzEVQIPofMb+SBa8DNC1jXRluokopeWX7ZeXBHOuLF8gK9Afs//2Q==","aspectRatio":1,"src":"/static/054e2aa5c688f14f7cdef9cee9915da9/61cdf/dain.jpg","srcSet":"/static/054e2aa5c688f14f7cdef9cee9915da9/7c20e/dain.jpg 25w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/fa1ea/dain.jpg 50w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/61cdf/dain.jpg 100w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/59538/dain.jpg 150w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/fd013/dain.jpg 200w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/25252/dain.jpg 400w","srcWebp":"/static/054e2aa5c688f14f7cdef9cee9915da9/66016/dain.webp","srcSetWebp":"/static/054e2aa5c688f14f7cdef9cee9915da9/74aad/dain.webp 25w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/e7b2c/dain.webp 50w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/66016/dain.webp 100w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/d9b14/dain.webp 150w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/6b183/dain.webp 200w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/fc32b/dain.webp 400w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQFAv/EABcBAAMBAAAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAbc3ufDLkZNGtkj5dIEf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAgMBERIABP/aAAgBAQABBQKSpI3wnUesjg16wWhlgCxV47zDDA//xAAbEQACAQUAAAAAAAAAAAAAAAAAAQMQERIhMf/aAAgBAwEBPwGPuzBOlz//xAAXEQADAQAAAAAAAAAAAAAAAAAAAhAS/9oACAECAQE/AWMX/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEREiExQQIQUv/aAAgBAQAGPwJRa2y7npeGsChbghjqWClYG+alyf/EABwQAQACAwADAAAAAAAAAAAAAAEAESExQVFxkf/aAAgBAQABPyEn6sYSsAcSYavkJNUDh8yzMFxDpL7jhZzBDSG4XQKz/9oADAMBAAIAAwAAABAP30D/xAAZEQEBAAMBAAAAAAAAAAAAAAABABEhMVH/2gAIAQMBAT8QQUbwRyy9v//EABoRAQEAAgMAAAAAAAAAAAAAAAEAESExYZH/2gAIAQIBAT8QKmp7Ps82C//EAB4QAQADAAICAwAAAAAAAAAAAAEAESExUUGBcaHR/9oACAEBAAE/EApCz0b59xINViPWShKK5tzEVQIPofMb+SBa8DNC1jXRluokopeWX7ZeXBHOuLF8gK9Afs//2Q==","aspectRatio":1,"src":"/static/054e2aa5c688f14f7cdef9cee9915da9/ec46e/dain.jpg","srcSet":"/static/054e2aa5c688f14f7cdef9cee9915da9/a2637/dain.jpg 82w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/15203/dain.jpg 164w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/ec46e/dain.jpg 328w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/25252/dain.jpg 400w","srcWebp":"/static/054e2aa5c688f14f7cdef9cee9915da9/5a48e/dain.webp","srcSetWebp":"/static/054e2aa5c688f14f7cdef9cee9915da9/2d087/dain.webp 82w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/29d87/dain.webp 164w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/5a48e/dain.webp 328w,\n/static/054e2aa5c688f14f7cdef9cee9915da9/fc32b/dain.webp 400w","sizes":"(max-width: 328px) 100vw, 328px"}}}],"basePath":"/","permalink":"https://www.danieldemmel.me/blog/2013/01/18/getting-cross-origin-resource-sharing-with-complex-jquery-ajax-requests//","slug":"/blog/2013/01/18/getting-cross-origin-resource-sharing-with-complex-jquery-ajax-requests/","id":"d3d0d05d-6c9e-551d-9a63-7598815c60eb","title":"Getting Cross-origin resource sharing with complex jQuery AJAX requests","canonicalUrl":null,"mailchimp":"","next":[{"id":"9c522b00-2704-5c8e-90aa-175a1f03dd9c","slug":"/blog/2012/09/02/setting-up-rmate-with-sublime-text-for-remote-file-editing-over-ssh/","secret":false,"title":"Setting up rmate with Sublime Text for remote file editing over SSH","author":"Daniel Demmel","date":"September 2nd, 2012","dateForSEO":"2012-09-02T00:00:00.000Z","timeToRead":1,"excerpt":"Instead of terminal editors with steep learning curve, this guide helps you to tunnel Sublime Text in to your server for remote editing. With sudo!","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Setting up rmate with Sublime Text for remote file editing over SSH\",\n  \"slug\": \"setting-up-rmate-with-sublime-text-for-remote-file-editing-over-ssh\",\n  \"date\": \"2012-09-02T00:00:00.000Z\",\n  \"categories\": [\"web\", \"development\", \"tools\", \"sublimetext\", \"ssh\"],\n  \"author\": \"Daniel Demmel\",\n  \"hero\": \"./images/terminal.jpg\",\n  \"excerpt\": \"Instead of terminal editors with steep learning curve, this guide helps you to tunnel Sublime Text in to your server for remote editing. With sudo!\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"If you want to be able to edit files using your local Sublime Text 2 / 3 app over SSH, you can use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rmate\"), \" which is a small remote connection script developed originally for TextMate.\"), mdx(\"p\", null, \"This is how it goes:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Install the \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/henrikpersson/rsub\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"rsub\"), \" plugin for ST, which is available through \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://packagecontrol.io/packages/Package%20Control\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Package Control\"), \" too.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add a remote forwarding line under the right host in your \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"~/.ssh/config\"), \" file to enable connection:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"Host myfancyvps\\n  Hostname 123.45.67.89\\n  RemoteForward 52698 127.0.0.1:52698\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"SSH in to your remote: \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"ssh myfancyvps\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Download rmate: \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"curl https://raw.githubusercontent.com/aurora/rmate/master/rmate > rmate\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Move it in place: \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"sudo mv rmate /usr/local/bin\"), \" \\u2013 you can put in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"~/bin\"), \" too if you only want to set it up for yourself, but sharing is caring :)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Make it executable: \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"sudo chmod +x /usr/local/bin/rmate\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Profit: \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"rmate .profile\"), \" \\u2013 make sure you have an open ST2 window to enable listening!\")), mdx(\"p\", null, \"The main reason why I really like this is because you can also \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo rmate\"), \" with system config files and be able to actually save them back, as opposed to editing via an SFTP client where you need to log in with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"root\"), \" to be able to do this.\"), mdx(\"p\", null, \"Also, don\\u2019t forget to open the port in your \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"iptables\"), \" if you have a restrictive firewall policy: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-A INPUT -p tcp --dport 52698 -j ACCEPT\"), \". Also you have to do \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"iptables-save\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"iptables-restore\"), \" to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://askubuntu.com/questions/66890/how-can-i-make-a-specific-set-of-iptables-rules-permanent\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"make these settings persistent after reboot\"), \".\"), mdx(\"p\", null, \"A slightly annoying caveat is that a port can\\u2019t be shared with other people if you happen to be logged in at the same time, so you might have to set up separate ports in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"iptables\"), \" with the first port number in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"RemoteForward\"), \" setting matching it (the local port should remain the same). In this case you have to specify the port number in each call though: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rmate -p 52699\"), \". So probably the best is to create an alias in your \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".profile\"), \": \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"alias rsub='rmate -p 52699'\"), \", but in this case you also need to add: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"alias sudo='sudo '\"), \". By adding that trailing space you make sure that the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo\"), \"\\u2018d command is also checked for alias substitution, so doing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo rsub my_system_config_file\"), \" will still work.\"), mdx(\"h2\", {\n    \"id\": \"credits\"\n  }, \"Credits\"), mdx(\"p\", null, \"Hero image: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.flickr.com/photos/stiefkind/41808172592\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://www.flickr.com/photos/stiefkind/41808172592\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBAgME/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAbZNIOEYkf/EABkQAAMBAQEAAAAAAAAAAAAAAAABAgMSI//aAAgBAQABBQLXymNW7jLqWkxRIz//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAcEAABAwUAAAAAAAAAAAAAAAAAAQIxEBESIVH/2gAIAQEABj8C6I1TKLmyKf/EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMVH/2gAIAQEAAT8hCIOnvJVpT8J3lziTxVwDYbi2f//aAAwDAQACAAMAAAAQRC//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QELb/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBFn//EABoQAQEAAwEBAAAAAAAAAAAAAAERACExUWH/2gAIAQEAAT8QpeaEGnh8zZoEkPvcNkMqSm33IM55cggDRnMQYOf/2Q==","aspectRatio":1.78125,"src":"/static/722836d547031f51c67552c5e16a9fa3/58fe7/terminal.jpg","srcSet":"/static/722836d547031f51c67552c5e16a9fa3/e0f30/terminal.jpg 236w,\n/static/722836d547031f51c67552c5e16a9fa3/86afd/terminal.jpg 472w,\n/static/722836d547031f51c67552c5e16a9fa3/58fe7/terminal.jpg 944w,\n/static/722836d547031f51c67552c5e16a9fa3/02748/terminal.jpg 1416w,\n/static/722836d547031f51c67552c5e16a9fa3/5c241/terminal.jpg 1888w,\n/static/722836d547031f51c67552c5e16a9fa3/5e32d/terminal.jpg 5472w","srcWebp":"/static/722836d547031f51c67552c5e16a9fa3/99fbb/terminal.webp","srcSetWebp":"/static/722836d547031f51c67552c5e16a9fa3/77392/terminal.webp 236w,\n/static/722836d547031f51c67552c5e16a9fa3/1f177/terminal.webp 472w,\n/static/722836d547031f51c67552c5e16a9fa3/99fbb/terminal.webp 944w,\n/static/722836d547031f51c67552c5e16a9fa3/4a492/terminal.webp 1416w,\n/static/722836d547031f51c67552c5e16a9fa3/b0b8f/terminal.webp 1888w,\n/static/722836d547031f51c67552c5e16a9fa3/abbc8/terminal.webp 5472w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBAgME/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAbZNIOEYkf/EABkQAAMBAQEAAAAAAAAAAAAAAAABAgMSI//aAAgBAQABBQLXymNW7jLqWkxRIz//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAcEAABAwUAAAAAAAAAAAAAAAAAAQIxEBESIVH/2gAIAQEABj8C6I1TKLmyKf/EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMVH/2gAIAQEAAT8hCIOnvJVpT8J3lziTxVwDYbi2f//aAAwDAQACAAMAAAAQRC//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QELb/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBFn//EABoQAQEAAwEBAAAAAAAAAAAAAAERACExUWH/2gAIAQEAAT8QpeaEGnh8zZoEkPvcNkMqSm33IM55cggDRnMQYOf/2Q==","aspectRatio":1.78125,"src":"/static/722836d547031f51c67552c5e16a9fa3/1dc0b/terminal.jpg","srcSet":"/static/722836d547031f51c67552c5e16a9fa3/3a5ce/terminal.jpg 163w,\n/static/722836d547031f51c67552c5e16a9fa3/05730/terminal.jpg 327w,\n/static/722836d547031f51c67552c5e16a9fa3/1dc0b/terminal.jpg 653w,\n/static/722836d547031f51c67552c5e16a9fa3/f72c7/terminal.jpg 980w,\n/static/722836d547031f51c67552c5e16a9fa3/6e4a3/terminal.jpg 1306w,\n/static/722836d547031f51c67552c5e16a9fa3/5e32d/terminal.jpg 5472w","srcWebp":"/static/722836d547031f51c67552c5e16a9fa3/0acdf/terminal.webp","srcSetWebp":"/static/722836d547031f51c67552c5e16a9fa3/ac59e/terminal.webp 163w,\n/static/722836d547031f51c67552c5e16a9fa3/7660b/terminal.webp 327w,\n/static/722836d547031f51c67552c5e16a9fa3/0acdf/terminal.webp 653w,\n/static/722836d547031f51c67552c5e16a9fa3/75470/terminal.webp 980w,\n/static/722836d547031f51c67552c5e16a9fa3/68d47/terminal.webp 1306w,\n/static/722836d547031f51c67552c5e16a9fa3/abbc8/terminal.webp 5472w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBAgME/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAbZNIOEYkf/EABkQAAMBAQEAAAAAAAAAAAAAAAABAgMSI//aAAgBAQABBQLXymNW7jLqWkxRIz//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAcEAABAwUAAAAAAAAAAAAAAAAAAQIxEBESIVH/2gAIAQEABj8C6I1TKLmyKf/EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMVH/2gAIAQEAAT8hCIOnvJVpT8J3lziTxVwDYbi2f//aAAwDAQACAAMAAAAQRC//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QELb/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBFn//EABoQAQEAAwEBAAAAAAAAAAAAAAERACExUWH/2gAIAQEAAT8QpeaEGnh8zZoEkPvcNkMqSm33IM55cggDRnMQYOf/2Q==","aspectRatio":1.78125,"src":"/static/722836d547031f51c67552c5e16a9fa3/eaa58/terminal.jpg","srcSet":"/static/722836d547031f51c67552c5e16a9fa3/5a3ee/terminal.jpg 114w,\n/static/722836d547031f51c67552c5e16a9fa3/41f8f/terminal.jpg 229w,\n/static/722836d547031f51c67552c5e16a9fa3/eaa58/terminal.jpg 457w,\n/static/722836d547031f51c67552c5e16a9fa3/c309b/terminal.jpg 686w,\n/static/722836d547031f51c67552c5e16a9fa3/e3008/terminal.jpg 914w,\n/static/722836d547031f51c67552c5e16a9fa3/5e32d/terminal.jpg 5472w","srcWebp":"/static/722836d547031f51c67552c5e16a9fa3/15384/terminal.webp","srcSetWebp":"/static/722836d547031f51c67552c5e16a9fa3/31fce/terminal.webp 114w,\n/static/722836d547031f51c67552c5e16a9fa3/e3e25/terminal.webp 229w,\n/static/722836d547031f51c67552c5e16a9fa3/15384/terminal.webp 457w,\n/static/722836d547031f51c67552c5e16a9fa3/0258d/terminal.webp 686w,\n/static/722836d547031f51c67552c5e16a9fa3/64ea2/terminal.webp 914w,\n/static/722836d547031f51c67552c5e16a9fa3/abbc8/terminal.webp 5472w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/722836d547031f51c67552c5e16a9fa3/0ff54/terminal.jpg"}}},{"id":"d3c65b46-4d3e-5f95-b874-d517929c6c2b","slug":"/blog/2021/08/08/run-a-containerised-openvpn-server-on-gcp-to-safely-access-your-home-nas-anywhere/","secret":false,"title":"Run a containerised OpenVPN server on GCP to safely access your home NAS anywhere","author":"Daniel Demmel","date":"August 8th, 2021","dateForSEO":"2021-08-08T00:00:00.000Z","timeToRead":3,"excerpt":"If your home network is on a shared IP but you want external to access your NAS on your home network, here's how you can set up your own, low cost OpenVPN server on GCP.","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Run a containerised OpenVPN server on GCP to safely access your home NAS anywhere\",\n  \"slug\": \"run-a-containerised-openvpn-server-on-gcp-to-safely-access-your-home-nas-anywhere\",\n  \"date\": \"2021-08-08T00:00:00.000Z\",\n  \"categories\": [\"openvpn\", \"networking\", \"nas\", \"synology\", \"gcp\"],\n  \"author\": \"Daniel Demmel\",\n  \"hero\": \"./images/lady-with-phone.jpg\",\n  \"excerpt\": \"If your home network is on a shared IP but you want external to access your NAS on your home network, here's how you can set up your own, low cost OpenVPN server on GCP.\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"motivation\"\n  }, \"Motivation\"), mdx(\"p\", null, \"After our recent house move I finally had the option to have a pure fibre connection with Hyperoptic which I was very happy about, but unfortunately as it turns out they are running carrier-grade NAT. That means our home connection is on a shared public IP, so I could no longer use port forwarding on our home router to connect to my OpenVPN server running on my Synology Diskstation NAS. This made me sad as it was a completely free of charge way for me to be able to secure my connection on my phone when connecting to a public Wi-Fi and I could also access all my files whenever and wherever.\"), mdx(\"p\", null, \"So I had to move the OpenVPN server somewhere outside of our home network and let both the NAS and all our devices connect to it. I also didn\\u2019t want to have to change the IP address of the NAS between connecting from home or via the VPN, so wanted to set up the route to the home IP range.\"), mdx(\"p\", null, \"I\\u2019m sure this all would also be possible with a commercial VPN provider, but as a little challenge I wanted to see if I can set this up using a free, micro VM in GCP, and luckily I was able to do it all in a couple of hours, thanks to a brilliant open source OpenVPN Docker image and the ability so easily run a container in a VM in GCP. In case you\\u2019re wondering, of course this guide will work with QNAP, FreeNAS, etc too, you\\u2019ll just need to figure out how to make it connect to OpenVPN as a client.\"), mdx(\"h2\", {\n    \"id\": \"how-to-do-it\"\n  }, \"How to do it\"), mdx(\"p\", null, \"So for my own future reference and to help anyone else interested, these are the steps involved:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Set up a Google Cloud Platform account (they have a free trial, but you\\u2019ll have to give them payment details): \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://console.cloud.google.com/freetrial\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://console.cloud.google.com/freetrial\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Create a firewall rule to allow OpenVPN traffic \\u2013 you need to open port 1194 for UDP and tag the rule to be able to assign to the VM later: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://console.cloud.google.com/networking/firewalls/add\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://console.cloud.google.com/networking/firewalls/add\")))), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1098px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"231.14754098360658%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAuCAIAAACnCq6RAAAACXBIWXMAABYlAAAWJQFJUiTwAAADKUlEQVRIx5WWa3OqMBCG+f9/rN/aD51xaq1Xbip3sVySAOcJsdg5FpUdjEtgs5t33+xipbkoa+X73mq1cl13s9mg2LZdFEXTNGpEpJSMlpBtUVTn8/l0OpkxyzJGHndd145I14vF6rPZDJ9YDrODjFmu12tCw7hJ0zTqhfvvXljIKDz90zhJEiGEhSZ6qeu6/BFWMcrDsBs2yUpVVXU30t4VbSx7+TPCMTFW1o+HDtPnrU22LFDxPK9foelX1D8TRXNX9J7B6XA4HMPEP6ZBmOb5yUie52DBCPJmxI2ZR2HE3qqq0rF3QXSK8+ZcqG6KWNFJbbxM1GU3XSypmu3O3u/3Sk3Am83qsPntdrswDB9mdUgS5FksFqBgcQ9DAOA/ePvEjVw/EWrP8/kcYutc9bNEUInGDWsvrJ2gDhLhR7Ub1PahOsQ1epKr5fIL9C3eHZhsWN2H0NYCDjVCNoCCYnQuPa9auAxGlhR1FAVEHseR4zicMLP5p9COs3L+ZbuOHQQByLHKBOPsW23dCJ5A18l5Vkqcc113MDYHeILxKS+W693e96lEr6+vZH8SPeViG0bhcVLAJkBLShGFwSScrp5J6cfHfLvdmrprwn5IbFLDCGDKHFEyfDweUQaqjQk1BEaAruY2UC2Xy+FsNI/kWgAx+Pz8fHl5eXt7I3JuVX84nxHrN0jPV89r3aatcT4HwJ8pncCkqycaOLFtmoaB6j5aPOVIgdG3PpJtizEFFP84/w0Yex/2fxu2BgxltVqDFtwke2DGEqb6Dh3X5O+3JfXjUoYIYyjOQ+MefN6Cf00Vr76/v3OSidz3fV4d2+qwFvS47HlqZzQLXdCmaOGWdsVIwiDMhINRlhUBu67Dl4hpnBOMaVFfu9j3HNfz6BsAzs5NJX5sDPC1kPjHJzwxBRj9GappwKQo0ySWPc5VWZT9F9gz5UQbh5nah+e2EUFKSUroCcdEHOJ7lx+JMO0/K5xAbtysa+p9LGfLiLay7x/fudxA8I42VrLK0iSKYnCCZjdp//vSgHUaMBHHSaoFImfmCwLYoO2dT7ELYPwNvQ7l3IuZMX1vTP4BMNt/jp6eB90AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/545a8fce1e5f649f28f3e32b396302a2/025a3/Firewall-setup.webp 1098w\"],\n    \"sizes\": \"(max-width: 1098px) 100vw, 1098px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/545a8fce1e5f649f28f3e32b396302a2/38ec7/Firewall-setup.png 1098w\"],\n    \"sizes\": \"(max-width: 1098px) 100vw, 1098px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/545a8fce1e5f649f28f3e32b396302a2/38ec7/Firewall-setup.png\",\n    \"alt\": \"Screenshot of firewall setup\",\n    \"title\": \"Screenshot of firewall setup\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://cloud.google.com/free/docs/gcp-free-tier\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"free tier\"), \" VM with Container-Optimized OS which will host the OpenVPN container \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"kylemanna/openvpn\"), \" in privileged mode (so that it can set up networking), making sure to attach a directory volume (to store the config files) and tagging it with the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"openvpn\"), \" network (so that you can reach the VM from the internet): \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://console.cloud.google.com/compute/instancesAdd\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://console.cloud.google.com/compute/instancesAdd\"))), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"938px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"256.92963752665247%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAzCAIAAAAYQr/UAAAACXBIWXMAABYlAAAWJQFJUiTwAAAE9klEQVRIx5VWS4/cRBD2v4FD4AdwIEL8E44gwREUEH8CictGJAq3nBGHRKwicYgiQUCb2ck+ZnZ2HvbYHj963G33w3abr91e7zCZ3cyWyq3udld3ddVX1eUQQnzfl1I2dycHwtPpNAzDOI4ZY/XepLV2yrIMApy9lFJgrDHb8v/W7WKQw1h+OZ2vac5yDi4rbblq14DQ6Sc3WevGyZiMUlrwkuUyL5RUGqxKndIqSFVIasq1LGuhavvLspCay9rJcr5K0ChZNmAuK8xiKSuqhFZTbx2lhSwh32CyZ6zBFg6uOxgcx3GSpiTLqDUjVAKDZtPp0lumhOBvhQvopmdjbUxlWRZHcRiEK0PRer3GbZUqpVRwYRTBD7FSCit7xhCWdvAbfkqSBCvSNEUfzoMlVUt5nmMG22FptUGQQtv52fcDtLPZjHNxB5Bgy/F4NLlAc55lBFMWAJZ6PLw7NH42Vln4b4bnb88uhqeTKCbQMwgCtLAl9AqvyA5xOyhsz4DBKteP5h545fpJuEpgWqyIogiGsC3ujBkYs5fshPFNJhdwResh3TZ7Uac2tgRIjW/UNpW7CPNFUXQnU0qhGzFISJOWbB/3FEI0NyjT3XmxWMznc8/ztAXOBr1fbYjBUbPZFFvApBheXl66rteqXbV6dmz7QF6ntt1FyEoAf1XZwtAKKBOPLVnfosX81smacV1IneZNSiVgapdateEk3BwboQ9JeM666lo4IPWvf4qnLyVhKo5WfhCkredAwDbCZic2O2s3uvbSirDKxmL/rwdj37dX6Mmp6oYWes0gXCP6w1QhF2l9W96zZAJDSEnWjGQ8JowVihUwcL1vVOFWg8GbV69eDo8Hr1//fTw4gtMRGHDbcrm0QeIbCgCH3hadMCwJSAFkMCbG1jfoI9yt24yDpSjxcW7NvpH0s/xoMDw5OUHE4CjgHCCBS8yBQeB5boLsxnRCa7hzW22kDhuAILwY2JtzjmOBarSmb4Bm0i3y37YwYDAcDkej0dnZmeu6MMEuSNc77W/8jAMhgxb2AGibPWK6e6sgAMMi9cFsBjB3eiVxKygchiuLHmvq2wlreGt5R5U1Ibj4Gt6yam9hcCdhjVEbD09CMmPwOIaTsMW7KeFGteGDKE7hVdwZeILDsAWGW3jYLazKJkkzJC+bX0GIwX0kjXAhlB+EQJKFCiTtO7SXMKPUXSz6dLH1srynJtk0Ty9z/ZreKo+ahAGVCAlEHFoM7wAS1CRhTFGWhBEqCLZmEiUDqhEvUl5sOMtNoVGIjrmos6JCQWNdhVizlYZuFyEH14RWcVZGa8OsneEbjPUWxw6KkZPT0fhiej6anJye44kF5soaGfvGIsrUUR22VSOqptSGRdkgh+eihrYTX1ws5dgT67zOec2uGH3k2U5tQuhk6s5df75YZrSQypZc1yy22tJUacCBKeKkyGka0vUqI2ElWVPzpuJ4f0ynFhr9qkDftFrpEtF+jR/nt7/4L4f8yYviyQv++DB/+Jw+fM4OntGDtrPFB8/Yo0P66A/68+/Z4RF3vvgp+uQ7//Mfg/vf+58+WH78jXvva/ejK763wfj14VeLz35Y3n+w/ODLxbePE2fk8n9G9N8xPbrIj6fi7VzezsczOZzJwUzOV9LRpfDm49nklJIQL9Te6GrhibyKummxcAtUvkjxqnwvS1nmuUk4/wERbmeiG1wCNwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/4aff51d9ab4098164f96c5d3dfbda7f4/c975b/VM-setup-1.webp 938w\"],\n    \"sizes\": \"(max-width: 938px) 100vw, 938px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/4aff51d9ab4098164f96c5d3dfbda7f4/88cea/VM-setup-1.png 938w\"],\n    \"sizes\": \"(max-width: 938px) 100vw, 938px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/4aff51d9ab4098164f96c5d3dfbda7f4/88cea/VM-setup-1.png\",\n    \"alt\": \"Screenshot of firewall setup - part 1\",\n    \"title\": \"Screenshot of firewall setup - part 1\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"958px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"253.23590814196245%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAzCAIAAAAYQr/UAAAACXBIWXMAABYlAAAWJQFJUiTwAAAEGklEQVRIx5WWyZLiOBCG/czzAv0Ic5qIvvV9jvMmE1WHphYg2AowXsGWZUmmPynBuBuaojMSRVo4ldufKUfW2iTQfr93zh0fJhQjFFar1cvLy3g8Loqi6zr3GBljvHJd12VZ5nmutb620P2GvGV+i8UCs3Eco8xBVVUppZCbM9207JU5g2g/Pj7m87ms0+mU45BXgTj0t25zwHa7xdSd3Fz7zCb63vJsNptMJpvNtm1b8xhh7JQwoiJhOI8XD6baBvKWkySFyfZ8vuC8P6mzteSVzMJK1TxSaPjYee6E3Q221kTGuKa12rjWc4csXClTVuZQm0rZfrPnWlvduqhp3V65qvmJ68ZtMjPdaHgRt4fGDbnSLq+s0i7Cewxes3W+IPzw0d5i/vXKh6ZLSrcrbFKapLRJYXaFSfc2lPMeeZBUgYyxF1Q8lvCIIs/ny8Vy1WrNQRyhtQfLmdlu2b/ZG77OrT2ui266Oya7GJwB5vV6vQkEclnxS0A6NEsuUHb72s5ikxy6LMtoCUEbJMIhEDINJ9jgkZ47WdamK9VR2yO7mJX24hSE5XJJY+EIj/yFMkeMx5PdbudjJqo0TWUYsOLhnSSD6nNLhZgB89vbG2OIVUYCjg2bcdgPvyaMNwgVZbry9fU1ZGodUhXDDMbQpnbIOEuNTsrMPUIiNkLN86IcEFmwVxT0jc82yrNVOnp5G41GuE1t0Ol9voMQr0wkoOD799Hz8/PT09P/gYiCPOP8Hf2TMlRVB3ESoraE9Ck2L8qPj+th8j22KRIe6oDtAGZPIpBoGeAisNnj/NRVhEeqmKFMbGTxXDADQKmFRMSKPLxVfLbZfX9/lyOgrnuwI48B21qDSnEJCx4TfirqAHun/VShH4xcPUP8Rbwk6AdnyHLXMtOLPK8b87pQo1m9K1qlqizL6QIaQ9LmESbKYAtUY19ycwG2f+9yxQyr4C1zBnkCFQAbg3KqwPD6iuj3ZfVdJR1LtFLwoZGhcG08whqpFlQTUhaIOrFSGIThJnLos1aO8NkmBySJNQ/Ee/KVkgZCYG6IX3JFXtwO03OO56QN4/13QPcZnUoFtsLQ8jkXD8Wxz0Hir5uWMqrQ5UaALY93PmVQ8W7zIyRuZvJChCFJhQDmlwr1dSI0+WhDuQtwtCEXlykVmkk+iLwgV4cQ7wUsO99V8uE0pMZf9Er2Wf0B5yaVf09u80Az47AMQCEww0r+wazcO4JfBKkLjUi+fcwBvjfCk1huAlPSGbJtueu6459TuNyVPSh35wuuv7S762EgeLq+U3rZ+zlor/61iO8lq8tW5RSYNFDh9Ewig4IsL9PSbjM+Okxdq96XaJu1f/+7+vrfepcdeFkuod6Xs0f+feGf3F7EzV//TL58m63jcrtdqwfGfU8/AFhgkh3CpnEkAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/afcd58bc0750385decc7602f38e21cc1/8ebf8/VM-setup-2.webp 958w\"],\n    \"sizes\": \"(max-width: 958px) 100vw, 958px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/afcd58bc0750385decc7602f38e21cc1/40dcc/VM-setup-2.png 958w\"],\n    \"sizes\": \"(max-width: 958px) 100vw, 958px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/afcd58bc0750385decc7602f38e21cc1/40dcc/VM-setup-2.png\",\n    \"alt\": \"Screenshot of firewall setup - part 2\",\n    \"title\": \"Screenshot of firewall setup - part 2\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"ol\", {\n    \"start\": 4\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Set up a (subdomain) DNS A record pointing to the external IP address of the VM instance or create a dynamic DNS account with a (free) provider of your choice\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Open an SSH connection into the VM \\u2013 check with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"pwd\"), \" if the VM user name matches with your Gmail username (otherwise you\\u2019ll need to update the container volume) and if you\\u2019re using a dynamic DNS provider set up its client now \\u2013 you\\u2019ll need to know the URL in the next step\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Follow the Quickstart steps (except \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Start OpenVPN server process\"), \" as that\\u2019s already taken care of by the VM) in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kylemanna/openvpn\"), \"\\u2019s README with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OVPN_DATA=\\\"ovpn-data-volume\\\"\"), \". You\\u2019ll need to repeat the last two (client certificate and configuration creation) steps for each client you want to connect with \\u2013 including your NAS (make sure you note its client name down) \\u2013 and you\\u2019ll need to download or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cat\"), \" the the generated \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"CLIENTNAME.ovpn\"), \" config files: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/kylemanna/docker-openvpn#quick-start\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://github.com/kylemanna/docker-openvpn#quick-start\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Set up the network route to your home network where the NAS is. For this, you\\u2019ll need to edit a couple of files in the VM in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"~/ovpn-data-volume\"), \". For more info on why these are needed, read this helpful OpenVPN guide: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://community.openvpn.net/openvpn/wiki/RoutedLans\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://community.openvpn.net/openvpn/wiki/RoutedLans\")))), mdx(\"p\", null, \"Edit the following section in openvpn.conf (for example using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo nano ~/ovpn-data-volume/openvpn.conf\"), \"), where \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"192.168.168\"), \" should be the IP range of your home network where your NAS is. If your home network is on the default \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"192.168.0\"), \" range, make sure you change it otherwise routing will blow up when you connect to a Wi-Fi with the same default range.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"### Route Configurations Below\\nroute 192.168.254.0 255.255.255.0\\nroute 192.168.168.0 255.255.255.0\\npush \\\"route 192.168.168.0 255.255.255.0\\\"\\nclient-to-client\\nclient-config-dir ccd\\n\")), mdx(\"p\", null, \"Add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"YOUR_NAS_CLIENT_NAME\"), \" to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"~/ovpn-data-volume\"), \" (for example using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo touch ~/ovpn-data-volume/ccd/YOUR_NAS_CLIENT_NAME && sudo nano ~/ovpn-data-volume/ccd/YOUR_NAS_CLIENT_NAME\"), \") with the following line:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"iroute 192.168.168.0 255.255.255.0\\n\")), mdx(\"ol\", {\n    \"start\": 8\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"At this point you will need to restart the container to make sure it picks up the new config. First find its ID with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"docker ps -a\"), \" then \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"docker container restart CONTAINER_ID\"), \". You can disconnect from SSH now.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Connect your NAS as a client. For Synology see: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://kb.synology.com/en-global/DSM/help/DSM/AdminCenter/connection_network_vpnclient\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://kb.synology.com/en-global/DSM/help/DSM/AdminCenter/connection_network_vpnclient\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Connect your phone or other device and enjoy using your NAS with the same connection settings as your home network! If you also want to secure your connection and route all traffic through VPN, you might need to add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"redirect-gateway def1\"), \" to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"CLIENTNAME.ovpn\"), \" file before importing, unless your OpenVPN client supports setting this separately.\"))), mdx(\"p\", null, \"I\\u2019m not sure if this will always be completely free to run in GCP, but should be fairly cheap. Keep an eye on your billing report just in case: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://console.cloud.google.com/billing\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://console.cloud.google.com/billing\")), mdx(\"h2\", {\n    \"id\": \"credits\"\n  }, \"Credits\"), mdx(\"p\", null, \"Hero image: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.tuoptometrista.com/ayudas-generales-para-personas-con-baja-vision/woman/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://www.tuoptometrista.com/ayudas-generales-para-personas-con-baja-vision/woman/\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAIB/9oADAMBAAIQAxAAAAHankZugIR//8QAGhABAAMAAwAAAAAAAAAAAAAAAQACEgMxM//aAAgBAQABBQKrH3e6LvlXRP/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ASf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGn/8QAGRAAAgMBAAAAAAAAAAAAAAAAABACESEx/9oACAEBAAY/Ai7xdI6v/8QAGRABAQEAAwAAAAAAAAAAAAAAEQEAITFR/9oACAEBAAE/IZF5ysoI61TWFB7pgqbpv//aAAwDAQACAAMAAAAQvz//xAAWEQEBAQAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QNZn/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBj/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARITFBgf/aAAgBAQABPxAODsJuqLtByvrAbQfYJVoKW2MzG8a9iY//2Q==","aspectRatio":1.775,"src":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/2cf93/lady-with-phone.jpg","srcSet":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/e0f30/lady-with-phone.jpg 236w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/86afd/lady-with-phone.jpg 472w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/2cf93/lady-with-phone.jpg 852w","srcWebp":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/9867d/lady-with-phone.webp","srcSetWebp":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/77392/lady-with-phone.webp 236w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/1f177/lady-with-phone.webp 472w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/9867d/lady-with-phone.webp 852w","sizes":"(max-width: 852px) 100vw, 852px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAIB/9oADAMBAAIQAxAAAAHankZugIR//8QAGhABAAMAAwAAAAAAAAAAAAAAAQACEgMxM//aAAgBAQABBQKrH3e6LvlXRP/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ASf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGn/8QAGRAAAgMBAAAAAAAAAAAAAAAAABACESEx/9oACAEBAAY/Ai7xdI6v/8QAGRABAQEAAwAAAAAAAAAAAAAAEQEAITFR/9oACAEBAAE/IZF5ysoI61TWFB7pgqbpv//aAAwDAQACAAMAAAAQvz//xAAWEQEBAQAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QNZn/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBj/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARITFBgf/aAAgBAQABPxAODsJuqLtByvrAbQfYJVoKW2MzG8a9iY//2Q==","aspectRatio":1.775,"src":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/1dc0b/lady-with-phone.jpg","srcSet":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/3a5ce/lady-with-phone.jpg 163w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/05730/lady-with-phone.jpg 327w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/1dc0b/lady-with-phone.jpg 653w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/2cf93/lady-with-phone.jpg 852w","srcWebp":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/0acdf/lady-with-phone.webp","srcSetWebp":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/ac59e/lady-with-phone.webp 163w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/7660b/lady-with-phone.webp 327w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/0acdf/lady-with-phone.webp 653w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/9867d/lady-with-phone.webp 852w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAIB/9oADAMBAAIQAxAAAAHankZugIR//8QAGhABAAMAAwAAAAAAAAAAAAAAAQACEgMxM//aAAgBAQABBQKrH3e6LvlXRP/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ASf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGn/8QAGRAAAgMBAAAAAAAAAAAAAAAAABACESEx/9oACAEBAAY/Ai7xdI6v/8QAGRABAQEAAwAAAAAAAAAAAAAAEQEAITFR/9oACAEBAAE/IZF5ysoI61TWFB7pgqbpv//aAAwDAQACAAMAAAAQvz//xAAWEQEBAQAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QNZn/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBj/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARITFBgf/aAAgBAQABPxAODsJuqLtByvrAbQfYJVoKW2MzG8a9iY//2Q==","aspectRatio":1.775,"src":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/eaa58/lady-with-phone.jpg","srcSet":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/5a3ee/lady-with-phone.jpg 114w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/41f8f/lady-with-phone.jpg 229w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/eaa58/lady-with-phone.jpg 457w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/c309b/lady-with-phone.jpg 686w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/2cf93/lady-with-phone.jpg 852w","srcWebp":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/15384/lady-with-phone.webp","srcSetWebp":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/31fce/lady-with-phone.webp 114w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/e3e25/lady-with-phone.webp 229w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/15384/lady-with-phone.webp 457w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/0258d/lady-with-phone.webp 686w,\n/static/34d8e00eca3a4a7ff796e7c7c91366e8/9867d/lady-with-phone.webp 852w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/34d8e00eca3a4a7ff796e7c7c91366e8/2cf93/lady-with-phone.jpg"}}}]}}}