<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[I am dain]]></title>
  <link href="http://danieldemmel.me/atom.xml" rel="self"/>
  <link href="http://danieldemmel.me/"/>
  <updated>2015-04-13T19:17:59+01:00</updated>
  <id>http://danieldemmel.me/</id>
  <author>
    <name><![CDATA[Daniel Demmel]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Why YOU  —  not Henry Ford  —  should design your working life]]></title>
    <link href="http://danieldemmel.me/blog/2014/04/13/why-you-not-henry-ford-should-design-your-working-life/"/>
    <updated>2014-04-13T19:11:00+01:00</updated>
    <id>http://danieldemmel.me/blog/2014/04/13/why-you-not-henry-ford-should-design-your-working-life</id>
    <content type="html"><![CDATA[<h2>Your life was designed 150 years ago</h2>

<p>Western middle-class living operates on a working pattern <a href="https://en.wikipedia.org/wiki/Eight-hour_day">invented in the 19th century</a>, grudgingly accepted by progressive capitalists like Henry Ford in the beginning of 20th century and finally written into law early to mid-20th century in most countries.</p>

<p>While certainly a lot of people realise this might not be ideal, just why are we — as global society — so timid about changing this pattern?</p>

<h2>First world problems</h2>

<p>Much of my argument doesn&#8217;t apply if you&#8217;re struggling with low pay, shift-based work or live in a developing country. But many of you reading this post will be fortunate enough to be getting paid to think about and solve problems in creative ways. Yet we know that our brains are incapable of working at their peak, for hours in a row, while our bodies are tied to a desk and our colleagues are buzzing around us.</p>

<blockquote><p>Chances are that you also earn more than what you <strong>really need</strong>, to spend the surplus on stuff you <strong>want but don&#8217;t need</strong> or have the time to enjoy anyway.</p></blockquote>

<p>Funnily, some of the nicest things which you <em>do actually</em> <em>need</em> and <a href="https://medium.com/@kidbombay/how-to-be-happy-be8b2dc0677">can really make you happy</a> don&#8217;t cost a lot of money: taking a walk in nature, relaxing with people you like, cooking some fresh food from scratch, giving time to enjoy the meal together with your family and friends immersed in conversations, or keeping a gratitude journal.</p>

<p>So why do we still choose to join the rush hour congestion every day, and with that, collectively invest in expensive and destructive infrastructure developments just to serve these one-hour time windows? Or, why do we create a binary choice between unemployment and low paid jobs or burning out with no time to rest in sight until we retire, being too old and ill to enjoy it?</p>

<h2>Is it about co-location then?</h2>

<p>Yes, being next to teammates and interacting in person is something which can&#8217;t (fully, yet) be replaced by telecommunication, but do or should we have meetings all day with the same people?</p>

<blockquote><p>Couldn&#8217;t we organise our discussions a bit smarter into clusters — both within a day and a week — and spend the rest of the time away from the hustle of the workspace, with space to think when we need it the most?</p></blockquote>

<p>Wouldn&#8217;t we still have enough chance for serendipitous conversation between colleagues from other parts of the company if only we made sure to spend our lunch time and coffee or tea breaks in the communal area rather than in front of our computers?</p>

<h2>Planet, people and economy</h2>

<p>What really changed my way of thinking about time is a brilliant and provocative study by the New Economics Foundation, called <a href="http://www.neweconomics.org/publications/entry/21-hours">21 hours</a> (as in work week). In this paper they argue that by shortening our time spent at work we could decrease overconsumption, stress, and traffic congestion while increasing the number people employed in quality jobs, community and political involvement, and general mental and physical wellbeing.</p>

<blockquote><p>Once you stop looking at life as a treadmill of 5 long working days and a short weekend — barely enough to gasp for breath —and give yourself permission to explore what else is possible, magic starts to happen in your mind.</p></blockquote>

<p>If you want a second opinion or to dig deeper, also take a look at the Institute for the Future&#8217;s <a href="http://www.iftf.org/our-work/people-technology/technology-horizons/the-future-of-work/">Future of Work study</a>.</p>

<p><img src="http://www.iftf.org/fileadmin/user_upload/images/More_Projects_Images/TH-FutureofWork.jpg" alt="Credits: © 2015 Institute for the Future | http://www.iftf.org/our-work/people-technology/technology-horizons/the-future-of-work/" /></p>

<h2>So what do I do?</h2>

<p>It&#8217;s all very well, I hear you say, but we can&#8217;t all just move to France with their leisurely work hours, can we? Well, as an example there&#8217;s a <a href="https://www.gov.uk/flexible-working">law in the UK</a> that allows you to ask for any form of flexible work arrangement and unless your employer has a very good reason why they can&#8217;t accommodate for your request — which is unlikely for an office job — you should be allowed to have your way.</p>

<p>So this is exactly what I did, about a year and a half ago, just after my son was born.</p>

<blockquote><p>My pattern is every Wednesday off with and an extra hour worked each day for the rest of the week. While first I thought about getting a long weekend, slicing the week into half and not having to work more than two days in a row — ever! — works incredibly well.</p></blockquote>

<p>To make this happen I had to sacrifice 10% of my salary which might sound a bit off-putting at first, but if you think of it this way: you&#8217;re giving up the highest taxed bit first, or you could also just decrease hours with the same percentage instead of a pay rise next time, suddenly it hurts much less.</p>

<h2>Power to the parents</h2>

<p>Apart from the decreased normal working pattern, I&#8217;m lucky enough to work for ustwo with a progressive paternity policy, enabling fathers to take over maternity time from mother and topping up the statutory pay to full salary.</p>

<p>I can&#8217;t even begin to describe how wonderful it was for me to be able to spend 2 months during last summer with my little boy, but having some discussions with a few colleagues I realised that this paternal time off has profound implications beyond a healthier, more balanced child and less stressed young mother — if these weren&#8217;t enough already!</p>

<blockquote><p>If men also take months off after a child has been born — and in general share looking after the little ones — the ridiculous and often subconscious stigma of mothers as &#8220;less dedicated&#8221; workers will all but disappear.</p></blockquote>

<p>Needless to say I was more than happy to bask in the glory of a gender equality champion after this realisation, but this is just a small step to close the gap for a more inclusive workplace. For me personally that is, I can&#8217;t feel grateful enough for this forward looking and generous policy!</p>

<h2>Time to design your life</h2>

<p>There&#8217;s no ultimate recommendation as everyone&#8217;s different, but you should give yourself time and space to think about what would be the best working pattern for you and what matters the most to you in life by filling in <a href="http://iwtmad.files.wordpress.com/2012/12/the-living-legacy-workbook6.pdf">The Living Legacy workbook (PDF)</a>. As part of this you should realise that it&#8217;s not a lack of dedication to your career at all to find the way to sustainably give your best instead of burning yourself out!</p>

<hr />

<p>This post was published originally on the ustwo blog: http://ustwo.com/blog/you-should-design-your-working-life/</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Build your Minimum Viable Product]]></title>
    <link href="http://danieldemmel.me/blog/2014/01/19/build-your-minimum-viable-product/"/>
    <updated>2014-01-19T01:27:00+00:00</updated>
    <id>http://danieldemmel.me/blog/2014/01/19/build-your-minimum-viable-product</id>
    <content type="html"><![CDATA[<p>I gave a talk about building and iterating an MVP at the brilliant Workplace Hackshop organised by <a href="http://www.hackhumanity.org/">HackHumanity</a>.</p>

<p>It&#8217;s a short presentation so take a look, but these are the just the main points for the busiest executives:</p>

<ul>
<li>Form key hypotheses – optimise for learning, not functionality</li>
<li>Express your main value proposition</li>
<li>Get it out – if you’re not ashamed of it you wasted time</li>
<li>Measure every user interaction</li>
<li>Know where your audience hangs out</li>
<li>Look for customers ready to pay</li>
<li>Fake it, kludge it, hack it together</li>
</ul>


<hr />

<script async class="speakerdeck-embed" data-id="a48d1b7062080131f8545aa390b2a9d4" data-ratio="1.62025316455696" src="http://danieldemmel.me//speakerdeck.com/assets/embed.js"></script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[An introduction to jQuery Deferred / Promise and the design pattern in general]]></title>
    <link href="http://danieldemmel.me/blog/2013/03/22/an-introduction-to-jquery-deferred-slash-promise/"/>
    <updated>2013-03-22T10:42:00+00:00</updated>
    <id>http://danieldemmel.me/blog/2013/03/22/an-introduction-to-jquery-deferred-slash-promise</id>
    <content type="html"><![CDATA[<p>I gave an introductory talk a while back at the <a href="http://www.meetup.com/londonajax/events/100830572/">London Ajax User Group</a> about jQuery Promises after which there was a lively debate, so I thought it would be great to post the content of the slides with some notes as a sort of tutorial.</p>

<p>Update (2012/09/01): As it turns out there was a nice video recorded of the talk, if you have 10 minutes free give it a watch!</p>

<div class="video-container">
  <iframe src="http://danieldemmel.me//player.vimeo.com/video/73539595?color=c9ff23" width="400" height="300" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> <p><a href="http://vimeo.com/73539595">Introduction to jQuery Promises / Deferreds - London Ajax User Group 12.02.2013.</a> from <a href="http://vimeo.com/daaain">Daniel Demmel</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
</div>


<p>The original presentation is on Github (made with <a href="https://github.com/infews/keydown">Keydown</a> as presentation engine which doesn&#8217;t seem to handle resizing well enough to be embeddable): <a href="http://daaain.github.com/jquery-deferred-intro/jquery-deferred-intro/slides.html">daaain.github.com/jquery-deferred-intro/jquery-deferred-intro/slides.html</a></p>

<h2>A simple CORS AJAX example</h2>

<p>As a simple scenario to optimise I set up a not very useful example of loading 2 articles from HTML5Rocks and showing the first sections of each.</p>

<iframe width="100%" height="300" src="http://jsfiddle.net/dain/87uPV/3/embedded/result" allowfullscreen="allowfullscreen" frameborder="0"></iframe>


<h2>So in which cases are Promises useful?</h2>

<h3>AJAX request handler spaghetti</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.html5rocks.com/en/tutorials/file/xhr2/&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">insertDiv1</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">insertDiv1</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">response</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;section&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.html5rocks.com/en/tutorials/audio/scheduling/&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">insertDiv2</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">insertDiv2</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">response</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;section&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">insertDiv1</span><span class="p">,</span> <span class="s1">&#39;&lt;hr/&gt;&#39;</span><span class="p">,</span> <span class="nx">insertDiv2</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Timing issues (DOM ready, animations, etc)</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.html5rocks.com/en/tutorials/file/xhr2/&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">insertDiv1</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">insertDiv1</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">response</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;section&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.html5rocks.com/en/tutorials/audio/scheduling/&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">insertDiv2</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">insertDiv2</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">response</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;section&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">insertDiv1</span><span class="p">,</span> <span class="s1">&#39;&lt;hr/&gt;&#39;</span><span class="p">,</span> <span class="nx">insertDiv2</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>But what are these Deferreds and Promises really?</h2>

<h3>Deferred</h3>

<ul>
<li>A proxy for an asynchronous, future event</li>
<li>Has an interface for getting <code>resolve()</code>d or <code>reject()</code>ed</li>
<li>Starts in <code>pending</code> state, can only be finished once</li>
<li>Calls listeners immediately (but always async) once resolved</li>
</ul>


<h3>Promise</h3>

<ul>
<li>Allows listening and state inspection (using <code>state()</code>), but completely immutable so no interface for resolution</li>
<li>Basic (jQuery specific) listeners are <code>done()</code> and <code>fail()</code></li>
<li>Can be chained with <code>then()</code> (used to be <code>pipe()</code>)</li>
<li>Can be grouped and processed using <code>$.when()</code></li>
</ul>


<h2>How do they work?</h2>

<h3>A canonical Deferred example</h3>

<p>Setting up a listener and triggering it with resolve:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>   <span class="nx">alert</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">deferred</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>This also works as it doesn&#8217;t matter if a Deferred is already resolved it will still trigger the callback we attach to it:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="nx">deferred</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>   <span class="nx">alert</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>A canonical Promise + When example</h3>

<p>Return a Promise from a method and attach a listener to it (can have more than one):</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">getPromise</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="nx">deferred</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">&quot;hurray&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">promise</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span> <span class="nx">getPromise</span><span class="p">()</span> <span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>   <span class="nx">alert</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>So let&#8217;s untangle our example</h3>

<p>Create a Promise for DOM ready and the two AJAX requests and wait for all of them to be fulfilled:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">getReady</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">deferredReady</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">deferredReady</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">deferredReady</span><span class="p">.</span><span class="nx">promise</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">firstRequest</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.html5rocks.com/en/tutorials/file/xhr2/&#39;</span> <span class="p">}),</span>
</span><span class='line'>    <span class="nx">secondRequest</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.html5rocks.com/en/tutorials/audio/scheduling/&#39;</span> <span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span> <span class="nx">getReady</span><span class="p">(),</span> <span class="nx">firstRequest</span><span class="p">,</span> <span class="nx">secondRequest</span>
</span><span class='line'><span class="p">).</span><span class="nx">done</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">readyResponse</span><span class="p">,</span> <span class="nx">firstResponse</span><span class="p">,</span> <span class="nx">secondResponse</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">insertDiv1</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">insertDiv1</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">firstResponse</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;section&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">insertDiv2</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">insertDiv2</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">secondResponse</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;section&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">insertDiv1</span><span class="p">,</span> <span class="s1">&#39;&lt;hr/&gt;&#39;</span><span class="p">,</span> <span class="nx">insertDiv2</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Another solution</h3>

<p>The AJAX request can be already fired off while we wait for the DOM (also showing how can we chain listeners with <code>then()</code>):</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">getReady</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">deferredReady</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">deferredReady</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">deferredReady</span><span class="p">.</span><span class="nx">promise</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">firstRequest</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.html5rocks.com/en/tutorials/file/xhr2/&#39;</span> <span class="p">}),</span>
</span><span class='line'>    <span class="nx">secondRequest</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.html5rocks.com/en/tutorials/audio/scheduling/&#39;</span> <span class="p">}),</span>
</span><span class='line'>    <span class="nx">firstDiv</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">secondDiv</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span> <span class="nx">firstRequest</span><span class="p">,</span> <span class="nx">secondRequest</span>
</span><span class='line'><span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">firstResponse</span><span class="p">,</span> <span class="nx">secondResponse</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">firstDiv</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">firstResponse</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;section&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>  <span class="nx">secondDiv</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">secondResponse</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;section&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">getReady</span><span class="p">();</span>
</span><span class='line'><span class="p">}).</span><span class="nx">done</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">readyResponse</span><span class="p">,</span> <span class="nx">firstResponse</span><span class="p">,</span> <span class="nx">secondResponse</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">firstDiv</span><span class="p">,</span> <span class="s1">&#39;&lt;hr/&gt;&#39;</span><span class="p">,</span> <span class="nx">secondDiv</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Dealing with rejection</h2>

<p>When a Promise gets <code>reject()</code>ed it will immediately cascade down the <code>then()</code> chain so you only need to handle it at the end (with jQuery it&#8217;s only since 1.8+ though).</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>getTweetsFor("domenic") // promise-returning function
</span><span class='line'>  .then(function (tweets) {
</span><span class='line'>    var shortUrls = parseTweetsForUrls(tweets);
</span><span class='line'>    var mostRecentShortUrl = shortUrls[0];
</span><span class='line'>    return expandUrlUsingTwitterApi(mostRecentShortUrl); // promise-returning function
</span><span class='line'>  })
</span><span class='line'>  .then(httpGet) // promise-returning function
</span><span class='line'>  .then(
</span><span class='line'>    function (responseBody) {
</span><span class='line'>      console.log("Most recent link text:", responseBody);
</span><span class='line'>    },
</span><span class='line'>    function (error) {
</span><span class='line'>      console.error("Error with the twitterverse:", error);
</span><span class='line'>    }
</span><span class='line'>  );</span></code></pre></td></tr></table></div></figure>


<p>I&#8217;ve taken this example from <a href="http://domenic.me/2012/10/14/youre-missing-the-point-of-promises/">Domenic Denicola&#8217;s blog post &#8220;You&#8217;re Missing the Point of Promises&#8221;</a> which is a great next step on the path of understanding Promises and asynchronous control flows. Go and read it now!</p>

<h2>A few more pointers</h2>

<ul>
<li>In case there&#8217;s a long request you can send updates to a <code>progress()</code> listener using <code>notify()</code></li>
<li>You can insert transformations into the <code>then()</code> chain</li>
</ul>


<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span> <span class="p">{</span> <span class="nx">testing</span><span class="o">:</span> <span class="mi">123</span> <span class="p">}</span> <span class="p">).</span><span class="nx">done</span><span class="p">(</span>
</span><span class='line'>  <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">testing</span><span class="p">);</span> <span class="p">}</span> <span class="cm">/* alerts &quot;123&quot; */</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>And finally it must be said that jQuery Deferred is by far not the only one, see <a href="http://wiki.commonjs.org/wiki/Promises/A">Promises/A spec</a> and the clarified <a href="http://promises-aplus.github.com/promises-spec/">Promises/A+ spec</a>. If you&#8217;re not already using jQuery then <a href="https://github.com/kriskowal/q">Q</a>, <a href="https://github.com/tildeio/rsvp.js">rsvp.js</a> or <a href="https://github.com/cujojs/when">when</a> might be better alternatives with seamless interoperability due to stricter adherence to the CommonJS specs.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Loading Javascript / CSS files from Jammit's assets.yml with Jasmine Gem to avoid duplication]]></title>
    <link href="http://danieldemmel.me/blog/2013/01/29/loading-javascript-source-files-from-jammits-assets-dot-yml-with-jasmine-gem/"/>
    <updated>2013-01-29T18:33:00+00:00</updated>
    <id>http://danieldemmel.me/blog/2013/01/29/loading-javascript-source-files-from-jammits-assets-dot-yml-with-jasmine-gem</id>
    <content type="html"><![CDATA[<p>Got a really handy bit of script working today, but it took me some time to figure out so thought I should post it.</p>

<p>Using the latest Jasmine Gem (only on Github master as of 2013/01/29) you just need to create <code>spec/javascripts/support/jasmine_helper.rb</code> and drop this in there (note that <code>jasmine_helper.rb</code> takes the responsibility of custom configs over from <code>jasmine_config.rb</code> from now on!):</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>require 'yaml'
</span><span class='line'>require 'erb'
</span><span class='line'>
</span><span class='line'>Jasmine.configure do |config|
</span><span class='line'>  jammitYaml = YAML.load(ERB.new(File.read('config/assets.yml')).result)
</span><span class='line'>  config.src_files = lambda { Jasmine::PathExpander.expand(config.src_dir, jammitYaml['javascripts']['workspace']) }
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>What it does is to load <code>assets.yml</code>, parse the YAML array <code>javascripts: workspace:</code>, uses Jasmine&#8217;s <code>PathExpander.expand</code> method to actually glob the files from the paths listed there and finally wraps the whole thing into a lambda so that it acts as a method.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting Cross-origin resource sharing with complex jQuery AJAX requests]]></title>
    <link href="http://danieldemmel.me/blog/2013/01/18/getting-cross-origin-resource-sharing-with-complex-jquery-ajax-requests/"/>
    <updated>2013-01-18T17:44:00+00:00</updated>
    <id>http://danieldemmel.me/blog/2013/01/18/getting-cross-origin-resource-sharing-with-complex-jquery-ajax-requests</id>
    <content type="html"><![CDATA[<p>I&#8217;m working on an HTML5 desktop application which needs to load some HTML text from a server, but not through an existing API. So I had to find a solution which can be set up without too much backend work and make it possible for non-technical people to easily update the content. I&#8217;m assuming that the easiest setup will be using an existing CMS system with a few custom server settings to enable cross-domain communication. It&#8217;s also a security sensitive application, so the content will need to be protected with basic authorisation at least.</p>

<p>Well, let me get things straight: CORS which is more than the simplest GET request is not easy!</p>

<p>While trying to set up and end to end proof of concept to make sure this will work and to be able to advise with setup I ran into several blockers, so I&#8217;m going to go through them step by step.</p>

<h2>Setting up the jQuery AJAX request</h2>

<p>For simple use cases all you need to do to is fire off a simple GET request:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$.ajax({
</span><span class='line'>  type: 'GET',
</span><span class='line'>  url: 'http://www.html5rocks.com/en/tutorials/file/xhr2/',
</span><span class='line'>  success: function(response) {
</span><span class='line'>      var article = $(response).find('article').html();
</span><span class='line'>      $('body').html(article);
</span><span class='line'>  }
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>If the server you&#8217;re hitting is sending back the header <code>Access-Control-Allow-Origin</code> with the value <code>*</code> you&#8217;re all set:</p>

<p><a class="jsbin-embed" href="http://jsbin.com/atobin/1/embed?live,javascript">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

<p>However what I ended up with is far more complicated, as doing anything with custom headers (which included authorisation) you have to first make a so called <a href="http://www.html5rocks.com/en/tutorials/cors/#toc-handling-a-not-so-simple-request">preflight</a> request. This is an OPTIONS request which only asks the server if it supports all the headers needed for the &#8216;real&#8217; request which follows.</p>

<p>So let&#8217;s first see the full AJAX request:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$.ajax({
</span><span class='line'>  type: 'GET',
</span><span class='line'>  url: 'http://www.mydomain.com/myFancyContent.php',
</span><span class='line'>  headers: {
</span><span class='line'>      'MyCustomHeader': 'important information'
</span><span class='line'>  },
</span><span class='line'>  xhrFields: {
</span><span class='line'>      withCredentials: true
</span><span class='line'>  },
</span><span class='line'>  username: 'myuser',
</span><span class='line'>  password: 'mypassword',
</span><span class='line'>  success: function() {
</span><span class='line'>      console.log('success');
</span><span class='line'>  },
</span><span class='line'>  error: function() {
</span><span class='line'>      console.log('failure');
</span><span class='line'>  }
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>JQuery has some helpers for authorisation, so the easiest way to get it working is setting <code>xhrFields.withCredentials</code> to <code>true</code> and passing <code>username</code> and <code>password</code> as separate parameters, this way we don&#8217;t have to worry about the intricacies of creating the auth hash ourselves.</p>

<p>Another convenience property is <code>headers</code> which you can use to inject any custom headers you might need, without having to manually do it with <code>beforeSend</code>.</p>

<h2>Apache config</h2>

<p>Another big stumbling block for me was to get the settings for Apache right.</p>

<p>The very first thing you need to do is making sure <code>mod_headers</code> is enabled, which can be as simple as:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ sudo a2enmod headers
</span><span class='line'>$ sudo /etc/init.d/apache2 force-reload</span></code></pre></td></tr></table></div></figure>


<p>Once that&#8217;s done, you can either edit your main <code>httpd.conf</code> or <code>apache.conf</code> files, or just create an <code>.htaccess</code> file in the folder you want to enable CORS in.</p>

<p>These are the settings I ended up with after a lot of experimentation:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>SetEnvIf Origin ^(.*)$ ORIGIN_DOMAIN=$0
</span><span class='line'>&lt;Files "*">
</span><span class='line'>  Header add Access-Control-Allow-Origin %{ORIGIN_DOMAIN}e
</span><span class='line'>  Header add Access-Control-Allow-Methods "GET, OPTIONS"
</span><span class='line'>  Header add Access-Control-Allow-Headers "Authorization, X-Requested-With, Content-Type, Origin, Accept"
</span><span class='line'>  Header add Access-Control-Allow-Credentials "true"
</span><span class='line'>&lt;/Files></span></code></pre></td></tr></table></div></figure>


<p>The first line makes sure that <code>Origin</code> is echoed back, because as it turns out once you have some custom headers a simple <code>*</code> in <code>Access-Control-Allow-Origin</code> won&#8217;t do any more. You can do some URL filtering here if you want, but this setup makes sure that even <code>file:///</code> works which is great for development.</p>

<p>In <code>Access-Control-Allow-Methods</code> we make sure that <code>OPTIONS</code> will work, and with <code>Access-Control-Allow-Headers</code> and <code>Access-Control-Allow-Credentials</code> we set everything up for a basic authorisation handshake.</p>

<p>Annoyingly none of these worked on the simple HTML file I uploaded, until as a desperate idea after a few hours of futile attempts I tried renaming it to PHP extension which made Apache suddenly apply all of them.</p>

<p>If that wasn&#8217;t enough, the unregistered development HTTPS security certificate also blocked my attempts to get things working. If you open any URL on the server you&#8217;re using and accept the certificate this problem will go away, otherwise the options are to <a href="http://superuser.com/questions/27268/how-do-i-disable-the-warning-chrome-gives-if-a-security-certificate-is-not-trust">install / import the certificate on a system level</a> or to start the browser with some flags like <code>--allow-running-insecure-content</code> for Chrome.</p>

<p>Hope this will help someone else facing the same problems!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Some thoughts on the fragile relationship between nature conservation and economic growth]]></title>
    <link href="http://danieldemmel.me/blog/2012/09/03/some-thoughts-on-the-fragile-relationship-between-nature-conservation-and-economic-growth/"/>
    <updated>2012-09-03T23:18:00+01:00</updated>
    <id>http://danieldemmel.me/blog/2012/09/03/some-thoughts-on-the-fragile-relationship-between-nature-conservation-and-economic-growth</id>
    <content type="html"><![CDATA[<p><em>Update: I started a small blog / public notebook of all things sustainable / resilient at <a href="http://transientresilient.tumblr.com/">transientresilient.tumblr.com</a></em></p>

<p>As part of the <a href="https://www.coursera.org/course/sustain">Sustainability course on Coursera</a> I&#8217;m currently taking, I had to write a forum post around population growth. It was inspired by an article about the dwindling richness of sound recordings in nature and tried to articulate some thoughts around incorporating nature conservation into the economy.</p>

<blockquote><p><strong>While human population might be internally sustainable, what about our lasting impact on nature?</strong></p>

<p>Just read an article about Bernie Krause experiencing the shocking loss of biodiversity around the World through audio recordings of wildlife taken a few years apart at the same spots: <a href="http://www.guardian.co.uk/environment/2012/sep/03/bernie-krause-natural-world-recordings">http://www.guardian.co.uk/environment/2012/sep/03/bernie-krause-natural-world-recordings</a></p>

<p>It&#8217;s crazy how little respect humanity as a whole has towards untouched nature&#8230; Maybe it&#8217;s time for it to be calculated as part of GDP so that land left alone to nature would contribute to this &#8220;sacred index&#8221; which seems to be the only thing which matters in the industrialised world? I wonder what could rein in our relentless colonisation of Earth with our population still set to rise at least for the next few decades.</p>

<p>Unfortunately the UN can&#8217;t force any country to do things differently than its often short-sighted politicians decide under the intoxicating lure of lobby money, maybe the best hope for a source of change could be regional supranational entities like the EU? The pollution / renewable energy generation targets mandated on the EU level are the only thing which I can see that is shaking the political elite into the barest minimum of action here in the UK. While the wealth generated here in London is just staggering, the city fails to meet basic air quality standards already pushed back from a few years ago after repeatedly failing to meet them.</p>

<p>I&#8217;m from Hungary in Eastern Europe originally, and having moved to the UK I&#8217;m really sad to see as I travel in the countryside here that the industrial revolution left precious little wild nature on this island. Maybe it&#8217;s actually a boon that Eastern Europe wasn&#8217;t caught up in such a crazy rate of &#8220;development&#8221; that the really important things are ignored and sacrificed on the altar of &#8220;progress&#8221;. Maybe it&#8217;s because of the agrarian heritage which inevitably comes with a level of respect towards nature?</p>

<p>In the end I guess my main question is: how could it be possible to include nature as part of the wealth of a nation so that capitalism takes notice?</p></blockquote>

<p>It also made me want to grab my sound recorder and go out to capture sounds of nature, maybe even juxtaposed with recordings from the city.</p>

<hr />

<p>Edit: Oh, just after writing this post I found an article which is just about how to value nature as wealth: <a href="http://www.guardian.co.uk/environment/2012/sep/03/ecuador-yasuni-conservation">http://www.guardian.co.uk/environment/2012/sep/03/ecuador-yasuni-conservation</a></p>

<p>While it starts off really promising&#8230;</p>

<blockquote><p>Just as the species must innovate to survive, Yasuni has inspired the planet&#8217;s most creative and ambitious approach to biodiversity conservation, social development and climate change. Ecuador – which is also home to the Galapagos Islands – is the only country in the world to have recognised the rights of nature in its constitution. After the discovery of a $7.2bn oil reserve inside a pristine corner of the Yasuni national park, the government has proposed leaving the fossil fuel in the ground if the international community will give them half that amount.</p></blockquote>

<p>&#8230;and mentions some interesting numbers and findings&#8230;</p>

<blockquote><p>The UNEP estimates that 40% of the global economy is based on biological products and processes. Biodiversity loss, it says, is becoming a greater concern for businesses than international terrorism.</p></blockquote>

<p>&#8230;apparently the biggest culprits don&#8217;t really care anyway:</p>

<blockquote><p>But what has happened since has been the opposite: because the US, UK and others can consume the assets generated by the amazon jungle for free, they have committed absolutely nothing. The Yasuni ITT initiative has raised a lot less than expected.</p></blockquote>

<p>The sliver of hope though is that while governments don&#8217;t care, people do:</p>

<blockquote><p>The ITT initiative, which covers the Ishpingo, Tambococha and Tiputini oil fields in Yasuni that make up an area of less than one-fifth of Yasuni&#8217;s national park, aims to address this in a core area for protection. Last year, it reached its target of raising $100m thanks to some creative accounting and generous public support (the UK was top for individual donations after featuring in the Guardian), and contributions from Bo Derek, Leonardo DiCaprio, Edward Norton and Al Gore.</p>

<p>Ivonne Baki, who is spearheading the fundraising effort, says the project has now raised $200m, but more is needed. &#8220;The cost of not doing something now will be far higher than the economic crisis. If we are serious about reducing emissions of CO2 and doing something – which is all they talk about at international meetings – then this is the place giving oxygen to the world.&#8221;</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Setting up rmate with Sublime Text for remote file editing over SSH]]></title>
    <link href="http://danieldemmel.me/blog/2012/09/02/setting-up-rmate-with-sublime-text-for-remote-file-editing-over-ssh/"/>
    <updated>2012-09-02T02:20:00+01:00</updated>
    <id>http://danieldemmel.me/blog/2012/09/02/setting-up-rmate-with-sublime-text-for-remote-file-editing-over-ssh</id>
    <content type="html"><![CDATA[<p>If you want to be able to edit files using your local Sublime Text 2 app over SSH, you can use <code>rmate</code> which is a small remote connection script developed originally for TextMate.</p>

<p>This is how it goes:</p>

<ul>
<li>Install the <a href="https://github.com/henrikpersson/rsub">rsub</a> plugin for ST2, which is available through <a href="http://wbond.net/sublime_packages/package_control">Package Control</a> too.</li>
<li>Add a remote forwarding line under the right host in your <code>~/.ssh/config</code> file to enable connection:</li>
</ul>


<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>Host myfancyvps
</span><span class='line'>  Hostname 123.45.67.89
</span><span class='line'>  RemoteForward 52698 127.0.0.1:52698</span></code></pre></td></tr></table></div></figure>


<ul>
<li>SSH in to your remote: <code>ssh myfancyvps</code></li>
<li>Download rmate: <code>curl https://raw.githubusercontent.com/aurora/rmate/master/rmate &gt; rmate</code></li>
<li>Move it in place: <code>sudo mv rmate /usr/local/bin</code> – you can put in <code>~/bin</code> too if you only want to set it up for yourself, but sharing is caring :)</li>
<li>Make it executable: <code>sudo chmod +x /usr/local/bin/rmate</code></li>
<li>Profit: <code>rmate .profile</code> – make sure you have an open ST2 window to enable listening!</li>
</ul>


<p>The main reason why I really like this is because you can also <code>sudo rmate</code> with system config files and be able to actually save them back, as opposed to editing via an SFTP client where you need to log in with <code>root</code> to be able to do this.</p>

<p>Also, don&#8217;t forget to open the port in your <code>iptables</code> if you have a restrictive / whitelist firewall policy: <code>-A INPUT -p tcp --dport 52698 -j ACCEPT</code>. Also you have to do <code>iptables-save</code> and <code>iptables-restore</code> to <a href="http://askubuntu.com/questions/66890/how-can-i-make-a-specific-set-of-iptables-rules-permanent">make these settings persistent after reboot</a>.</p>

<p>A slightly annoying caveat is that a port can&#8217;t be shared with other people if you happen to be logged in at the same time, so you might have to set up separate ports in <code>iptables</code> with the first port number in the <code>RemoteForward</code> setting matching it (the local port should remain the same). In this case you have to specify the port number in each call though: <code>rmate -p 52699</code>. So probably the best is to create an alias in your <code>.profile</code>: <code>alias rsub='rmate -p 52699'</code>, but in this case you also need to add: <code>alias sudo='sudo '</code>. By adding that trailing space you make sure that the <code>sudo</code>&#8216;d command is also checked for alias substitution, so doing <code>sudo rsub my_system_config_file</code> will still work.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Setting up Octopress]]></title>
    <link href="http://danieldemmel.me/blog/2012/05/17/setting-up-octopress/"/>
    <updated>2012-05-17T22:18:00+01:00</updated>
    <id>http://danieldemmel.me/blog/2012/05/17/setting-up-octopress</id>
    <content type="html"><![CDATA[<h2>Steps I&#8217;ve taken</h2>

<p>Note: &#8216;username&#8217; is your Github username and &#8216;myblog&#8217; is the name of your blog / site which you&#8217;ll have to replace in the instructions. Don&#8217;t sweat too much about the latter, it&#8217;s just a project name you won&#8217;t necessary have to use on your site.</p>

<h3>Set up Github repository for hosting</h3>

<p>Go to: https://github.com/new</p>

<p>Fill in form and create repo called &#8220;username.github.com&#8221;</p>

<h3>Set up Octopress <a href="http://octopress.org/docs/setup/">&#8594;</a></h3>

<p>If you don&#8217;t have it yet, install <a href="https://github.com/sstephenson/rbenv#section_2">rbenv</a> and <a href="https://github.com/sstephenson/ruby-build#installing-ruby-build">ruby-build</a> (to handle Ruby runtimes and build gems). If you&#8217;re on Windows this is going to be a bit more complicated, but setting up <a href="http://rubyinstaller.org/downloads">RubyInstaller</a> and <a href="https://github.com/oneclick/rubyinstaller/wiki/Development-Kit">Ruby Development Kit</a> is not that bad.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ rbenv install 1.9.2-p290
</span><span class='line'>$ git clone git://github.com/imathis/octopress.git myblog
</span><span class='line'>$ cd myblog
</span><span class='line'>$ gem install bundler
</span><span class='line'>$ rbenv rehash
</span><span class='line'>$ bundle install
</span><span class='line'>$ rbenv rehash</span></code></pre></td></tr></table></div></figure>


<h3>Get a nice theme <a href="http://zespia.tw/Octopress-Theme-Slash/">&#8594;</a></h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ git clone git://github.com/tommy351/Octopress-Theme-Slash.git .themes/slash
</span><span class='line'>$ rake install['slash']</span></code></pre></td></tr></table></div></figure>


<h3>Configure Octopress <a href="http://octopress.org/docs/configuring/">&#8594;</a></h3>

<p>Edit at least &#8220;Main Configs&#8221; in _config.yml. You can come back later to fill in the rest.</p>

<h3>Set site up for Github Pages</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ rake setup_github_pages</span></code></pre></td></tr></table></div></figure>


<p>Paste your Github repo URL: git@github.com:username/username.github.com.git when prompted.</p>

<p>This will set up some folders and the structure of the Git repos. <code>Master</code> branch will track the actual generated website (the contents of <code>_deploy</code> folder) and <code>source</code> will be the sources you are going to edit.</p>

<h3>Create your first post <a href="http://octopress.org/docs/blogging/">&#8594;</a></h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ rake new_post["Hello World!"]</span></code></pre></td></tr></table></div></figure>


<p>Edit contents of myblog/source/_posts/yyyy-mm-dd-hello-world.markdown</p>

<h3>Generate page and see it in your browser <a href="http://octopress.org/docs/deploying/github/">&#8594;</a></h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ rake generate
</span><span class='line'>$ powify create myblog
</span><span class='line'>$ powify browse myblog</span></code></pre></td></tr></table></div></figure>


<p>See if it&#8217;s all good locally</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ rake deploy</span></code></pre></td></tr></table></div></figure>


<p>Check the real thing: http://username.github.com</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[puts 'Hello world']]></title>
    <link href="http://danieldemmel.me/blog/2012/05/17/puts-hello-world/"/>
    <updated>2012-05-17T21:48:00+01:00</updated>
    <id>http://danieldemmel.me/blog/2012/05/17/puts-hello-world</id>
    <content type="html"><![CDATA[<p>A brave new blog, this time powered by the impressive dream team of <a href="http://www.ruby-lang.org/">Ruby</a>, <a href="http://compass-style.org/">Compass</a>, <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://octopress.org/">Octopress</a> and <a href="https://github.com/">Github</a>.</p>

<p>No database to worry about, back up and restore. Everything is in a Git repository, kindly hosted and served up to the world by Github.</p>

<p>All content is created in <a href="http://en.wikipedia.org/wiki/Markdown">Markdown</a>, hand typed in <a href="http://mouapp.com/">Mou.app</a>.</p>
]]></content>
  </entry>
  
</feed>
